<!doctype html>
<html lang="en-GB">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Gilead Couriers — Book a Job</title>

    <style>
      body {
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
        margin: 0;
        padding: 24px;
        color:#111;
        background:
          linear-gradient(180deg, rgba(11,31,59,0.92), rgba(11,31,59,0.65)),
          url("/app/images/hero-courier.jpg");
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
      }

      .wrap {
        max-width: 760px;
        margin: 0 auto;
      }

      .card {
        background: rgba(255,255,255,0.94);
        border-radius: 12px;
        padding: 20px;
        border: 1px solid rgba(255,255,255,0.6);
        box-shadow: 0 14px 34px rgba(0,0,0,0.18);
        backdrop-filter: blur(3px);
      }

      h1 { margin: 0 0 8px; font-size: 24px; }
      p.sub { margin: 0 0 20px; color:#444; }

      label { display:block; font-weight:600; margin: 14px 0 6px; }

      input, textarea, select {
        width:100%;
        box-sizing:border-box;
        padding: 10px 12px;
        border: 1px solid #d7dbe7;
        border-radius: 10px;
        font-size: 14px;
        background: #fff;
      }

      textarea { min-height: 76px; resize: vertical; }

      .row { display:flex; gap: 12px; }
      .row > div { flex:1; }

      .hint { font-size: 12px; color:#666; margin-top: 6px; }

      .btn {
        margin-top: 18px;
        width:100%;
        padding: 12px 14px;
        border:0;
        border-radius: 12px;
        font-weight:700;
        cursor:pointer;
        background:#111;
        color:#fff;
        font-size: 15px;
      }

      .btn:disabled {
        opacity: 0.65;
        cursor: not-allowed;
      }

      .footer {
        margin-top: 14px;
        font-size: 12px;
        color:#555;
      }

      .footer a {
        text-decoration: underline;
        text-underline-offset: 2px;
        color: inherit;
      }

      .footer a:hover {
        color:#0B1F3B;
      }

      .status {
        margin-top: 10px;
        font-size: 13px;
        color: #111;
      }
      .status.error { color: #b00020; }
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="card">
        <h1>Book a courier job</h1>
        <p class="sub">
          Dedicated A-to-B courier service. Secure payment via Stripe.
        </p>

        <form id="bookingForm">

          <div class="row">
            <div>
              <label for="company">Company / Business name *</label>
              <input id="company" type="text" required />
            </div>
            <div>
              <label for="industry">Industry *</label>
              <select id="industry" required>
                <option value="">Select industry</option>
                <option>Aerospace</option>
                <option>Defence</option>
                <option>Engineering</option>
                <option>Legal</option>
                <option>Medical</option>
                <option>Financial Services</option>
                <option>Government / Public Sector</option>
                <option>Other</option>
              </select>
            </div>
          </div>

          <label for="pickup">Pickup address *</label>
          <textarea id="pickup" required></textarea>

          <label for="dropoff">Drop-off address *</label>
          <textarea id="dropoff" required></textarea>

          <div class="row">
            <div>
              <label for="miles">Estimated miles *</label>
              <input id="miles" type="number" min="1" step="1" required />
              <div class="hint">Use Google Maps for a best estimate.</div>
            </div>
            <div>
              <label for="email">Your email address *</label>
              <input id="email" type="email" required />
            </div>
          </div>

          <div class="row">
            <div>
              <label for="whenDate">Date *</label>
              <input id="whenDate" type="date" required />
            </div>
            <div>
              <label for="whenTime">Time *</label>
              <input id="whenTime" type="time" required />
            </div>
          </div>

          <label for="notes">Notes (optional)</label>
          <textarea id="notes"></textarea>

          <button class="btn" id="submitBtn" type="submit">
            Book &amp; Pay
          </button>

          <div id="status" class="status"></div>

          <div class="footer">
            By proceeding you agree to our
            <a href="/terms.html">Terms</a>,
            <a href="/refund-policy.html">Refund Policy</a> and
            <a href="/privacy-policy.html">Privacy Policy</a>.
          </div>
        </form>
      </div>
    </div>

    <script>
      (function () {
        const ENDPOINT = "/api/stripe/create-checkout-session-v2";
        const form = document.getElementById("bookingForm");
        const statusEl = document.getElementById("status");
        const submitBtn = document.getElementById("submitBtn");

        function val(id) {
          return document.getElementById(id).value.trim();
        }

        form.addEventListener("submit", async (e) => {
          e.preventDefault();
          submitBtn.disabled = true;
          statusEl.textContent = "Redirecting to secure payment…";

          const payload = {
            company: val("company"),
            industry: val("industry"),
            pickup: val("pickup"),
            dropoff: val("dropoff"),
            miles: val("miles"),
            email: val("email"),
            whenDate: val("whenDate"),
            whenTime: val("whenTime"),
            notes: val("notes")
          };

          try {
            const r = await fetch(ENDPOINT, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(payload)
            });

            const d = await r.json();
            if (!r.ok || !d.url) throw new Error();

            window.location.href = d.url;
          } catch {
            statusEl.textContent = "Unable to start payment. Please try again.";
            statusEl.className = "status error";
            submitBtn.disabled = false;
          }
        });
      })();
    </script>
  </body>
</html>
